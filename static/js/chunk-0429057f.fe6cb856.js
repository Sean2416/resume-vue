(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0429057f","chunk-2d20fe6b","chunk-2d0f003d","chunk-2d23031f"],{6900:function(e,t,a){"use strict";a.d(t,"c",(function(){return o})),a.d(t,"a",(function(){return l})),a.d(t,"d",(function(){return r})),a.d(t,"b",(function(){return s}));var n=a("b775");function o(e,t,a){var o={userType:e,username:t,identity:a};return Object(n["a"])({url:"/getUserProfile",method:"post",data:o})}function l(e,t){var a={identity:e,username:t};return Object(n["a"])({url:"/coupon/getCouponOverview",method:"post",data:a})}function r(e){var t={userId:e};return Object(n["a"])({url:"/coupon/resetPrint",method:"post",data:t})}function s(e,t,a,o,l,r,s,i,u){var c={identity:e,username:t,role:a,couponType:o,storeType:l,startDate:r,endDate:s,rows:i,page:u};return Object(n["a"])({url:"/coupon/transactionHistory",method:"post",data:c})}},"691e":function(e,t,a){},"898e":function(e,t,a){"use strict";var n=a("691e"),o=a.n(n);o.a},"9b20":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.dataList,"empty-text":"暫無資料"}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form",{staticClass:"table-expand",attrs:{"label-position":"left",inline:""}},[a("el-form-item",{staticClass:"table-expand-item",attrs:{label:"消費店家名稱"}},[a("span",[e._v(e._s(t.row.storeName))])]),e._v(" "),a("el-form-item",{staticClass:"table-expand-item",attrs:{label:"消費店家類型"}},[a("span",[e._v(e._s(t.row.storeTypeLabel))])])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"抵用券序號",prop:"couponId"}}),e._v(" "),a("el-table-column",{attrs:{label:"抵用券金額",prop:"amount"}}),e._v(" "),a("el-table-column",{attrs:{label:"消費時間",prop:"consumeTime"}}),e._v(" "),a("el-table-column",{attrs:{label:"是否使用",prop:"isUsedLabel"}})],1)],1)},o=[],l=(a("ac6a"),a("1157")),r=a.n(l),s=a("4214"),i={name:"CustomerInfo",props:{dataList:{type:Array,required:!0,default:[]}},data:function(){return{options:s}},watch:{dataList:{deep:!0,immediate:!0,handler:function(e){var t=this;t.dataList.forEach((function(e){e.storeTypeLabel=t.convertStoreType(e.storeType);var a=r.a.grep(t.options.usedType,(function(t){return t.value==e.isUsed}));a.length>0&&(e.isUsedLabel=a[0].label)}))}}}},u=i,c=a("2877"),p=Object(c["a"])(u,n,o,!1,null,null,null);t["default"]=p.exports},"9e03":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("loadingPage",{attrs:{loadingText:e.loadingText}}),e._v(" "),a("el-card",[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("消費者查詢")])]),e._v(" "),a("el-form",{ref:"query",staticClass:"queryBlock",attrs:{"status-icon":"",size:"mini",model:e.query}},[a("el-form-item",{attrs:{label:"帳號"}},[a("el-input",{staticClass:"input-with-select",attrs:{disabled:e.queryDisable,clearable:""},model:{value:e.query.username,callback:function(t){e.$set(e.query,"username",t)},expression:"query.username"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"身分證號碼"}},[a("el-input",{staticClass:"input-with-select",attrs:{disabled:e.queryDisable,clearable:""},model:{value:e.query.identity,callback:function(t){e.$set(e.query,"identity",t)},expression:"query.identity"}})],1),e._v(" "),a("el-form-item",{staticClass:"btnBlock"},[a("el-button",{attrs:{type:"primary",disabled:e.queryDisable},on:{click:e.getUserInfo}},[e._v("查詢")]),e._v(" "),a("el-button",{attrs:{type:"danger"},on:{click:e.init}},[e._v("清除")])],1)],1)],1),e._v(" "),a("el-card",[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("消費者資料")])]),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.userList,border:"","empty-text":"暫無資料"}},[a("el-table-column",{attrs:{width:"50",align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"medium",icon:"el-icon-view"},on:{click:function(a){return e.selectUser(t.row)}}})]}}])}),e._v(" "),a("el-table-column",{attrs:{type:"expand",label:"明細"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form",{staticClass:"table-expand",attrs:{"label-position":"left",inline:""}},[a("el-form-item",{staticClass:"table-expand-item",attrs:{label:"生日"}},[a("span",[e._v(e._s(t.row.birthday))])]),e._v(" "),a("el-form-item",{staticClass:"table-expand-item",attrs:{label:"電子信箱"}},[a("span",[e._v(e._s(t.row.email))])])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"姓名",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"username",label:"帳號",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"identity",label:"身分證",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"mobile",label:"手機號碼",sortable:""}})],1)],1),e._v(" "),a("el-card",[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("抵用券資料")]),e._v(" "),"P"===e.coupon.couponType?a("el-button",{staticStyle:{float:"right","margin-right":"10px"},attrs:{type:"danger",plain:"",icon:"el-icon-refresh"},on:{click:function(t){return e.resetPrintStatus()}}},[e._v("重置列印狀態")]):e._e()],1),e._v(" "),a("el-form",{staticClass:"showInfo"},[a("el-form-item",{attrs:{label:"領取方式"}},[a("el-input",{attrs:{readonly:""},model:{value:e.coupon.couponTypeLabel,callback:function(t){e.$set(e.coupon,"couponTypeLabel",t)},expression:"coupon.couponTypeLabel"}})],1),e._v(" "),"P"===e.coupon.couponType?a("el-form-item",{attrs:{label:"兌換碼"}},[a("el-input",{attrs:{readonly:""},model:{value:e.coupon.printCode,callback:function(t){e.$set(e.coupon,"printCode",t)},expression:"coupon.printCode"}})],1):e._e(),e._v(" "),"P"===e.coupon.couponType?a("el-form-item",{attrs:{label:"列印時間"}},[a("el-input",{attrs:{readonly:""},model:{value:e.coupon.printTime,callback:function(t){e.$set(e.coupon,"printTime",t)},expression:"coupon.printTime"}})],1):e._e(),e._v(" "),"P"===e.coupon.couponType?a("el-form-item",{attrs:{label:"列印狀態"}},[a("el-input",{attrs:{placeholder:""},model:{value:e.coupon.couponPrintType,callback:function(t){e.$set(e.coupon,"couponPrintType",t)},expression:"coupon.couponPrintType"}})],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"申請業者"}},[a("el-input",{attrs:{readonly:""},model:{value:e.coupon.applyHotel,callback:function(t){e.$set(e.coupon,"applyHotel",t)},expression:"coupon.applyHotel"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"發券時間"}},[a("el-input",{attrs:{readonly:""},model:{value:e.coupon.applyTime,callback:function(t){e.$set(e.coupon,"applyTime",t)},expression:"coupon.applyTime"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"已使用金額"}},[a("el-input",{attrs:{readonly:""},model:{value:e.coupon.consumed,callback:function(t){e.$set(e.coupon,"consumed",t)},expression:"coupon.consumed"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"剩餘金額"}},[a("el-input",{attrs:{readonly:""},model:{value:e.coupon.balance,callback:function(t){e.$set(e.coupon,"balance",t)},expression:"coupon.balance"}})],1)],1),e._v(" "),a("el-table",{staticClass:"couponTable",staticStyle:{width:"100%"},attrs:{data:e.coupon.couponTypeInfo,border:"","empty-text":"暫無資料"}},[a("el-table-column",{attrs:{width:"50",label:"明細"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"medium",icon:"el-icon-tickets"},on:{click:function(a){return e.showDetail(t.row)}}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"typeName",label:"抵用券類別",width:"180",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"consumed",label:"已使用金額",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"balance",label:"剩餘金額\t",sortable:""}})],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"抵用券類別清單",visible:e.dialogCouponInfo,width:"80%"},on:{"update:visible":function(t){e.dialogCouponInfo=t}}},[a("couponInfoTable",{attrs:{dataList:e.couponInfoList}})],1)],1)},o=[],l=a("b634"),r=a("9b20"),s=a("eaf3"),i=a("6900"),u=a("5c96"),c={name:"CouponConsumerQuery",components:{consumerInfo:l["default"],couponInfoTable:r["default"],loadingPage:s["default"]},data:function(){return{queryDisable:!1,loadingText:null,query:{username:null,identity:null},selectedRow:{},userList:[],coupon:{},couponInfoList:[],dialogCouponInfo:!1}},mounted:function(){this.init()},methods:{init:function(){var e=this;e.query={username:null,identity:null},e.userList=[],e.coupon={},e.selectedRow={},e.couponInfoList=[],e.resetForm("query"),e.queryDisable=!1},selectUser:function(e){var t=this;t.coupon={},t.getCouponOverview(e)},showDetail:function(e){this.dialogCouponInfo=!0,this.couponInfoList=e.couponInfo},queryParamValid:function(){var e=this;return null!==e.query.username&&""!==e.query.username||null!==e.query.identity&&""!==e.query.identity||(e.createWarm("請至少輸入一個查詢條件"),!1)},getUserInfo:function(){var e=this;e.queryParamValid()&&(e.loadingText="搜尋中",Object(i["c"])("C",e.query.username,e.query.identity).then((function(t){e.loadingText=null,e.checkResponseValue(t.result,"consumer")?(e.userList=e.convertDataToArray(t.result.consumer),e.queryDisable=!0):e.createWarm("查無資料")})).catch((function(t){e.loadingText=null})))},getCouponOverview:function(e){var t=this;t.selectedRow=e,t.loadingText="搜尋中",Object(i["a"])(e.identity,e.username).then((function(e){t.loadingText=null,t.checkResponseValue(e.result,"couponOverview")?(t.coupon=e.result.couponOverview,t.coupon.couponTypeInfo=t.convertDataToArray(t.coupon.couponTypeInfo)):t.createWarm("查無資料")})).catch((function(e){t.loadingText=null}))},resetPrintStatus:function(){var e=this;u["MessageBox"].confirm("確定要還原列印狀態?","警告",{confirmButtonText:"確認",cancelButtonText:"取消",type:"warning"}).then((function(){e.loadingText="重置中",Object(i["d"])(e.selectedRow.userId).then((function(t){e.getCouponOverview(e.selectedRow)})).catch((function(t){e.loadingText=null}))}))}},watch:{"coupon.couponType":function(){var e=this;e.coupon.couponTypeLabel=e.convertCouponType(e.coupon.couponType)}}},p=c,d=(a("898e"),a("2877")),m=Object(d["a"])(p,n,o,!1,null,"c9a45f7e",null);t["default"]=m.exports},b634:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-card",[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("消費者資料")])]),e._v(" "),a("el-form",{staticClass:"showInfo"},[a("el-form-item",{attrs:{label:"帳號"}},[a("el-input",{attrs:{readonly:""},model:{value:e.userData.username,callback:function(t){e.$set(e.userData,"username",t)},expression:"userData.username"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"姓名"}},[a("el-input",{attrs:{readonly:""},model:{value:e.userData.name,callback:function(t){e.$set(e.userData,"name",t)},expression:"userData.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"身分證"}},[a("el-input",{attrs:{readonly:""},model:{value:e.userData.identity,callback:function(t){e.$set(e.userData,"identity",t)},expression:"userData.identity"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"生日"}},[a("el-input",{attrs:{readonly:""},model:{value:e.userData.birthday,callback:function(t){e.$set(e.userData,"birthday",t)},expression:"userData.birthday"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"手機號碼"}},[a("el-input",{attrs:{readonly:""},model:{value:e.userData.mobile,callback:function(t){e.$set(e.userData,"mobile",t)},expression:"userData.mobile"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"電子信箱"}},[a("el-input",{attrs:{readonly:""},model:{value:e.userData.email,callback:function(t){e.$set(e.userData,"email",t)},expression:"userData.email"}})],1)],1)],1)],1)},o=[],l={name:"ConsumerInfo",props:{userData:{type:Object,required:!0}},data:function(){return{}},methods:{}},r=l,s=a("2877"),i=Object(s["a"])(r,n,o,!1,null,null,null);t["default"]=i.exports},eaf3:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],attrs:{"element-loading-text":e.loadingText,"element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"}})])},o=[],l={props:{loadingText:{type:String,default:null}},data:function(){return{fullscreenLoading:!1}},watch:{loadingText:function(){this.fullscreenLoading=null!=this.loadingText}}},r=l,s=a("2877"),i=Object(s["a"])(r,n,o,!1,null,null,null);t["default"]=i.exports}}]);